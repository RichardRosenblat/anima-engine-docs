# ADR-011: Event-Based Input Architecture with Natural Language, System, and Semantic Events

**Status:** Accepted  
**Date:** 2026-01-07  
**Deciders:** @RichardRosenblat  
**Context:** Modularity, Observability, Interruptions, Optional NLP

---

## Context

Directly coupling the Core to raw inputs (audio, text, sensors) causes tight coupling, duplicated NLP logic, and unsafe implicit behavior. To preserve modularity, safety, and traceability, the Core must consume only structured events via a unified contract.

---

## Decision

The ANIMA Core consumes only structured input events, never raw signals.

All inputs—human, system, or environmental—MUST be transformed into events by modules (via their Adapter) before reaching the Core.

Event types are canonical and namespaced:
- input.nl — natural language (pre-semantic)
- input.system — non-linguistic, mechanical/system facts
- input.semantic — post-interpretation asserted meaning

---

## Event Envelope

All input events MUST use the event envelope:
- payload MUST be structured and deterministic
- include execution_id, trace_id, span_id, thread_id, timestamp
- any additional metadata per ADR-004

---

## Canonical Event Categories

### 1) Natural Language (input_nl; Pre-Semantic)
Represents raw linguistic content after capture/transcription, without interpretation.

Characteristics:
- no intent
- no assumptions
- low trust
- provenance="observed"

Example:
```json
{
  "execution_id": "exec-123",
  "trace_id": "trace-aaa",
  "span_id": "span-001",
  "parent_span_id": null,
  "thread_id": "input-mic-1",
  "timestamp": "2026-01-07T12:34:56Z",
  "source": "module:microphone",
  "type": "input.nl",
  "payload": {
    "text": "send this file to discord",
    "language": "en-US",
    "confidence": 0.93,
    "provenance": "observed"
  }
}
```

---

### 2) System / Mechanical (input.system; Non-Natural-Language)
Represents observable facts or state changes, not language.

Characteristics:
- deterministic facts
- high trust
- no linguistic interpretation required

Example:
```json
{
  "execution_id": "exec-123",
  "trace_id": "trace-bbb",
  "span_id": "span-010",
  "parent_span_id": null,
  "thread_id": "input-vscode",
  "timestamp": "2026-01-07T12:35:10Z",
  "source": "module:vscode",
  "type": "input.system",
  "payload": {
    "action": "file_opened",
    "path": "/project/main.py"
  }
}
```

---

### 3) Semantic (input.semantic; Post-Interpretation)
Represents asserted meaning extracted by an NLP layer of an NLP-capable module or the optional Arcuate.

Characteristics:
- explicit intent + confidence + provenance
- Core reasons directly on these
- bypasses further linguistic processing

Example:
```json
{
  "execution_id": "exec-123",
  "trace_id": "trace-ccc",
  "span_id": "span-020",
  "parent_span_id": null,
  "thread_id": "nlp-arcuate",
  "timestamp": "2026-01-07T12:35:20Z",
  "source": "adapter:arcuate",
  "type": "input.semantic",
  "payload": {
    "intent": "send_message",
    "target": "discord",
    "content_ref": "file://active",
    "confidence": 0.88,
    "provenance": "arcuate"
  }
}
```

---

## Arcuate Role (ADR-009)

- The core's Arcuate is a translator (NLP), not a controller
- Responsibilities:
  - consume input.nl events
  - produce input.semantic events
- Constraints:
  - optional and swappable
  - MUST NOT access Core memory directly
  - MUST NOT perform planning
  - semantic payloads MUST include confidence and provenance

Modules may produce input.semantic directly if they embed NLP; the Core remains agnostic to the origin of meaning.

---

## Core Responsibilities

The Core SHALL:
- ingest events via a unified event queue
- reason only over events, not raw signals
- treat input.semantic as asserted meaning subject to safety policies
- use events to drive planning, task creation, interruption, and policy enforcement

---

## Interruptions as Events (ADR-005)

Interruptions enter as input events:

```json
{
  "type": "input.semantic",
  "payload": {
    "intent": "interrupt",
    "target": "speech_output",
    "urgency": "high",
    "confidence": 0.95,
    "provenance": "arcuate|module"
  }
}
```

This enables consistent classification (override/cancel/queue/clarification/emergency), policy enforcement, and traceability.

---

## Observability & Traceability (ADR-004)

All events:
- carry execution and correlation IDs
- are logged as structured records in execution-partitioned timelines
- support replayability, auditability, and concurrent visibility

---

## Consequences

### Positive
- Strong decoupling between Core and modules
- Clear trust boundaries
- Natural interruption handling
- Safer, auditable behavior
- Future clustering/distribution readiness

### Trade-offs
- Requires disciplined event schemas
- Needs visualization tooling
- Modules must adhere to event contracts

---

## Related ADRs

- ADR-003 — Core ↔ Module protocol, leases
- ADR-004 — Observability model
- ADR-005 — Interruption model
- ADR-007 — Infrastructure & adapter rules
- ADR-009 — Optional Arcuate (NLP)
- ADR-010 — Adapter–Actuator split

---

## Final Statement

ANIMA is an event-reasoning engine.  
Meaning enters the Core already shaped as input events.  
Adapters standardize, the kernel supervises, and the Core reasons.